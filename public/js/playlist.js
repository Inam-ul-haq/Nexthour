/**
 * videojs-playlist
 * @version 4.2.0
 * @copyright 2018 Brightcove, Inc.
 * @license Apache-2.0
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):e.videojsPlaylist=t(e.videojs)}(this,function(e){"use strict";e=e&&e.hasOwnProperty("default")?e["default"]:e;var t=function(e){var t=e.playlist.autoadvance_;t.timeout&&e.clearTimeout(t.timeout),t.trigger&&e.off("ended",t.trigger),t.timeout=null,t.trigger=null},r=function l(e,r){var n;(t(e),"number"==typeof(n=r)&&!isNaN(n)&&n>=0&&n<Infinity)?(e.playlist.autoadvance_.delay=r,e.playlist.autoadvance_.trigger=function(){var n=function(){return l(e,r)};e.one("play",n),e.playlist.autoadvance_.timeout=e.setTimeout(function(){t(e),e.off("play",n),e.playlist.next()},1e3*r)},e.one("ended",e.playlist.autoadvance_.trigger)):e.playlist.autoadvance_.delay=null},n=function(e,t){var n=!e.paused()||e.ended();return e.trigger("beforeplaylistitem",t),e.poster(t.poster||""),e.src(t.sources),function(e){for(var t=e.remoteTextTracks(),r=t&&t.length||0;r--;)e.removeRemoteTextTrack(t[r])}(e),e.ready(function(){(t.textTracks||[]).forEach(e.addRemoteTextTrack.bind(e)),e.trigger("playlistitem",t),n&&e.play(),r(e,e.playlist.autoadvance_.delay)}),e},o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=(function(){function e(e){this.value=e}function t(t){var r,n;function o(r,n){try{var u=t[r](n),a=u.value;a instanceof e?Promise.resolve(a.value).then(function(e){o("next",e)},function(e){o("throw",e)}):i(u.done?"return":"normal",u.value)}catch(l){i("throw",l)}}function i(e,t){switch(e){case"return":r.resolve({value:t,done:!0});break;case"throw":r.reject(t);break;default:r.resolve({value:t,done:!1})}(r=r.next)?o(r.key,r.arg):n=null}this._invoke=function(e,t){return new Promise(function(i,u){var a={key:e,arg:t,resolve:i,reject:u,next:null};n?n=n.next=a:(r=n=a,o(e,t))})},"function"!=typeof t["return"]&&(this["return"]=undefined)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype["throw"]=function(e){return this._invoke("throw",e)},t.prototype["return"]=function(e){return this._invoke("return",e)}}(),function(e,t){for(var r=0;r<e.length;r++){var n=e[r].sources;if(Array.isArray(n))for(var i=0;i<n.length;i++){var u=n[i];if(u&&(c=void 0,f=void 0,c=a=u,f=l=t,"object"===(void 0===a?"undefined":o(a))&&(c=a.src),"object"===(void 0===l?"undefined":o(l))&&(f=l.src),/^\/\//.test(c)&&(f=f.slice(f.indexOf("//"))),/^\/\//.test(f)&&(c=c.slice(c.indexOf("//"))),c===f))return r}}var a,l,c,f;return-1}),u=function(e){for(var t=-1,r=e.length-1;++t<e.length;){var n=t+Math.floor(Math.random()*(r-t+1)),o=e[n];e[n]=e[t],e[t]=o}return e};var a=function(o,a){!function(o,a){var l=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,c=null,f=!1,s=o.playlist=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(f)throw new Error("do not call playlist() during a playlist change");if(Array.isArray(e)){var r=Array.isArray(c)?c.slice():null;c=e.slice(),f=!0,o.trigger({type:"duringplaylistchange",nextIndex:t,nextPlaylist:c,previousIndex:s.currentIndex_,previousPlaylist:r||[]}),f=!1,-1!==t&&s.currentItem(t),r&&o.setTimeout(function(){o.trigger("playlistchange")},0)}return c.slice()};o.on("loadstart",function(){-1===s.currentItem()&&t(o)}),s.currentIndex_=-1,s.player_=o,s.autoadvance_={},s.repeat_=!1,s.currentItem=function(e){return f?s.currentIndex_:("number"==typeof e&&s.currentIndex_!==e&&e>=0&&e<c.length?(s.currentIndex_=e,n(s.player_,c[s.currentIndex_])):s.currentIndex_=s.indexOf(s.player_.currentSrc()||""),s.currentIndex_)},s.contains=function(e){return-1!==s.indexOf(e)},s.indexOf=function(e){if("string"==typeof e)return i(c,e);for(var t=Array.isArray(e)?e:e.sources,r=0;r<t.length;r++){var n=t[r];if("string"==typeof n)return i(c,n);if(n.src)return i(c,n.src)}return-1},s.currentIndex=function(){return s.currentItem()},s.lastIndex=function(){return c.length-1},s.nextIndex=function(){var e=s.currentItem();if(-1===e)return-1;var t=s.lastIndex();return s.repeat_&&e===t?0:Math.min(e+1,t)},s.previousIndex=function(){var e=s.currentItem();return-1===e?-1:s.repeat_&&0===e?s.lastIndex():Math.max(e-1,0)},s.first=function(){if(!f)return c.length?c[s.currentItem(0)]:void(s.currentIndex_=-1)},s.last=function(){if(!f)return c.length?c[s.currentItem(s.lastIndex())]:void(s.currentIndex_=-1)},s.next=function(){if(!f){var e=s.nextIndex();return e!==s.currentIndex_?c[s.currentItem(e)]:void 0}},s.previous=function(){if(!f){var e=s.previousIndex();return e!==s.currentIndex_?c[s.currentItem(e)]:void 0}},s.autoadvance=function(e){r(s.player_,e)},s.repeat=function(t){return t===undefined?s.repeat_:"boolean"==typeof t?(s.repeat_=!!t,s.repeat_):void e.log.error("videojs-playlist: Invalid value for repeat",t)},s.sort=function(e){c.length&&(c.sort(e),f||o.trigger("playlistsorted"))},s.reverse=function(){c.length&&(c.reverse(),f||o.trigger("playlistsorted"))},s.shuffle=function(){var e,t=(arguments.length>0&&arguments[0]!==undefined?arguments[0]:{}).rest,r=0,n=c;(t&&(r=s.currentIndex_+1,n=c.slice(r)),n.length<=1)||(u(n),t&&(e=c).splice.apply(e,[r,n.length].concat(n)),f||o.trigger("playlistsorted"))},Array.isArray(a)?s(a.slice(),l):c=[]}(this,o,a)};return(e.registerPlugin||e.plugin)("playlist",a),a});