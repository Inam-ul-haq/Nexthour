/**
 * videojs-playlist-ui
 * @version 3.3.0
 * @copyright 2017 Brightcove, Inc.
 * @license Apache-2.0
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):e.videojsPlaylistUi=t(e.videojs)}(this,function(e){"use strict";e=e&&e.hasOwnProperty("default")?e["default"]:e;var t,i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n={},l=(Object.freeze||Object)({"default":n}),s=l&&n||l,a=void 0!==i?i:"undefined"!=typeof window?window:{};"undefined"!=typeof document?t=document:(t=a["__GLOBAL_DOCUMENT_CACHE@4"])||(t=a["__GLOBAL_DOCUMENT_CACHE@4"]=s);var r=t,o=(function(){function e(e){this.value=e}function t(t){function i(l,s){try{var a=t[l](s),r=a.value;r instanceof e?Promise.resolve(r.value).then(function(e){i("next",e)},function(e){i("throw",e)}):n(a.done?"return":"normal",a.value)}catch(o){n("throw",o)}}function n(e,t){switch(e){case"return":l.resolve({value:t,done:!0});break;case"throw":l.reject(t);break;default:l.resolve({value:t,done:!1})}(l=l.next)?i(l.key,l.arg):s=null}var l,s;this._invoke=function(e,t){return new Promise(function(n,a){var r={key:e,arg:t,resolve:n,reject:a,next:null};s?s=s.next=r:(l=s=r,i(e,t))})},"function"!=typeof t["return"]&&(this["return"]=undefined)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype["throw"]=function(e){return this._invoke("throw",e)},t.prototype["return"]=function(e){return this._invoke("return",e)}}(),function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}),p=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},u=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},c=e.dom||e,d=e.registerPlugin||e.plugin,h={className:"vjs-playlist",playOnSelect:!1,supportsCssPointerEvents:function(){var e=r.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}()},y=function(e){e.addClass("vjs-selected")},f=function(e){e.removeClass("vjs-selected"),e.thumbnail&&c.removeClass(e.thumbnail,"vjs-playlist-now-playing")},m=function(e){e.removeClass("vjs-up-next")},v=e.getComponent("Component"),w=function(t){function i(e,n,l){if(o(this,i),!n.item)throw new Error("Cannot construct a PlaylistMenuItem without an item option");var s=u(this,t.call(this,e,n));return s.item=n.item,s.playOnSelect=l.playOnSelect,s.emitTapEvents(),s.on(["click","tap"],s.switchPlaylistItem_),s.on("keydown",s.handleKeyDown_),s}return p(i,t),i.prototype.handleKeyDown_=function(e){13!==e.which&&32!==e.which||this.switchPlaylistItem_()},i.prototype.switchPlaylistItem_=function(e){this.player_.playlist.currentItem(function(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1}(this.player_.playlist(),this.item)),this.playOnSelect&&this.player_.play()},i.prototype.createEl=function(){var t=r.createElement("li"),i=this.options_.item;if(t.className="vjs-playlist-item",t.setAttribute("tabIndex",0),this.thumbnail=function(e){if(!e){var t=r.createElement("div");return t.className="vjs-playlist-thumbnail vjs-playlist-thumbnail-placeholder",t}var i=r.createElement("picture");if(i.className="vjs-playlist-thumbnail","string"==typeof e){var n=r.createElement("img");n.src=e,n.alt="",i.appendChild(n)}else{for(var l=0;l<e.length-1;l++){var s=e[l],a=r.createElement("source");for(var o in s)a[o]=s[o];i.appendChild(a)}var p=e[e.length-1],u=r.createElement("img");u.alt="";for(var c in p)u[c]=p[c];i.appendChild(u)}return i}(i.thumbnail),t.appendChild(this.thumbnail),i.duration){var n=r.createElement("time"),l=e.formatTime(i.duration);n.className="vjs-playlist-duration",n.setAttribute("datetime","PT0H0M"+i.duration+"S"),n.appendChild(r.createTextNode(l)),t.appendChild(n)}var s=r.createElement("span"),a=this.localize("Now Playing");s.className="vjs-playlist-now-playing-text",s.appendChild(r.createTextNode(a)),s.setAttribute("title",a),this.thumbnail.appendChild(s);var o=r.createElement("div");o.className="vjs-playlist-title-container",this.thumbnail.appendChild(o);var p=r.createElement("span"),u=this.localize("Up Next");p.className="vjs-up-next-text",p.appendChild(r.createTextNode(u)),p.setAttribute("title",u),o.appendChild(p);var c=r.createElement("cite"),d=i.name||this.localize("Untitled Video");return c.className="vjs-playlist-name",c.appendChild(r.createTextNode(d)),c.setAttribute("title",d),o.appendChild(c),t},i}(v),C=function(t){function i(n,l){if(o(this,i),!n.playlist)throw new Error("videojs-playlist is required for the playlist component");var s=u(this,t.call(this,n,l));return s.items=[],l.horizontal?s.addClass("vjs-playlist-horizontal"):s.addClass("vjs-playlist-vertical"),l.supportsCssPointerEvents&&s.addClass("vjs-csspointerevents"),s.createPlaylist_(),e.browser.TOUCH_ENABLED||s.addClass("vjs-mouse"),n.on(["loadstart","playlistchange","playlistsorted"],function(e){s.update()}),n.on("adstart",function(){s.addClass("vjs-ad-playing")}),n.on("adend",function(){s.removeClass("vjs-ad-playing")}),s}return p(i,t),i.prototype.createEl=function(){return c.createEl("div",{className:this.options_.className})},i.prototype.createPlaylist_=function(){var e=this.player_.playlist()||[],t=this.el_.querySelector(".vjs-playlist-item-list"),i=this.el_.querySelector(".vjs-playlist-ad-overlay");t||((t=r.createElement("ol")).className="vjs-playlist-item-list",this.el_.appendChild(t));for(var n=0;n<this.items.length;n++)t.removeChild(this.items[n].el_);this.items.length=0;for(var l=0;l<e.length;l++){var s=new w(this.player_,{item:e[l]},this.options_);this.items.push(s),t.appendChild(s.el_)}i?t.appendChild(i):((i=r.createElement("li")).className="vjs-playlist-ad-overlay",t.appendChild(i));var a=this.player_.playlist.currentItem();if(this.items.length&&a>=0){y(this.items[a]);var o=this.items[a].$(".vjs-playlist-thumbnail");o&&c.addClass(o,"vjs-playlist-now-playing")}},i.prototype.update=function(){var e=this.player_.playlist();if(this.items.length===e.length){for(var t=0;t<this.items.length;t++)if(this.items[t].item!==e[t])return void this.createPlaylist_();for(var i=this.player_.playlist.currentItem(),n=0;n<this.items.length;n++){var l=this.items[n];n===i?(y(l),r.activeElement!==l.el()&&c.addClass(l.thumbnail,"vjs-playlist-now-playing"),m(l)):n===i+1?(f(l),function(e){e.addClass("vjs-up-next")}(l)):(f(l),m(l))}}else this.createPlaylist_()},i}(v),j=function(t){if(!this.playlist)throw new Error("videojs-playlist plugin is required by the videojs-playlist-ui plugin");if(c.isEl(t)&&(e.log.warn('videojs-playlist-ui: Passing an element directly to playlistUi() is deprecated, use the "el" option instead!'),t={el:t}),t=e.mergeOptions(h,t),this.playlistMenu){var i=this.playlistMenu.el();if(i){var n=i.parentNode,l=i.nextSibling;this.playlistMenu.dispose(),c.emptyEl(i),l?n.insertBefore(i,l):n.appendChild(i),t.el=i}}c.isEl(t.el)||(t.el=function(e){for(var t=r.querySelectorAll("."+e),i=void 0,n=0;n<t.length;n++)if(!function(e){for(var t=0;t<e.childNodes.length;t++)if(c.isEl(e.childNodes[t]))return!0;return!1}(t[n])){i=t[n];break}return i}(t.className)),this.playlistMenu=new C(this,t)};return e.registerComponent("PlaylistMenu",C),e.registerComponent("PlaylistMenuItem",w),d("playlistUi",j),j});